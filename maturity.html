<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="referrer" content="strict-origin-when-cross-origin">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'">
  <title>Maturity Assessment - Zero Trust</title>
  <link rel="stylesheet" href="css/style.css">
  <script src="js/theme.js"></script>
  <style>
      .question-card {
          background-color: var(--secondary-bg);
          padding: 2rem;
          border-radius: 8px;
          border: 1px solid var(--border-color);
          margin-bottom: 2rem;
      }
      .options {
          display: flex;
          flex-direction: column;
          gap: 1rem;
          margin-top: 1rem;
      }
      .option {
          padding: 1rem;
          background-color: var(--card-bg);
          border: 1px solid var(--border-color);
          border-radius: 6px;
          cursor: pointer;
          transition: border-color 0.2s;
      }
      .option:hover {
          border-color: var(--accent-color);
      }
      .option:focus-visible {
          outline: none;
          border-color: var(--accent-color);
          box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.3);
      }
      .option.selected {
          border-color: var(--success-color);
          background-color: rgba(35, 134, 54, 0.1);
      }
      #result-container {
          text-align: center;
          padding: 3rem;
          display: none;
      }
      .maturity-badge {
          font-size: 2rem;
          padding: 1rem 2rem;
          border-radius: 4rem;
          margin-top: 1rem;
          display: inline-block;
      }
  </style>
</head>
<body>
  <header style="padding: 4rem 1rem;">
    <div class="nav-bar">
        <a href="index.html">Home</a>
        <a href="tools.html">Tools</a>
        <a href="compliance.html">Compliance</a>
        <a href="policy.html">Policy</a>
        <a href="maturity.html" class="active">Maturity</a>
        <button id="themeToggle" type="button" class="theme-toggle" aria-label="Switch to light mode">&#9790;</button>
    </div>
    <h1>Zero Trust Maturity Assessment</h1>
    <p>Benchmark your organization against the CISA Zero Trust Maturity Model.</p>
  </header>

  <main>
    <div id="quiz">
        <div class="question-card" data-pillar="Identity">
            <h3 id="question-identity">Identity: How is MFA implemented?</h3>
            <div class="options" role="radiogroup" aria-labelledby="question-identity">
                <div class="option" data-score="1" role="radio" aria-checked="false" tabindex="0">Traditional Passwords / No MFA</div>
                <div class="option" data-score="2" role="radio" aria-checked="false" tabindex="-1">SMS/Email OTP (Basic MFA)</div>
                <div class="option" data-score="3" role="radio" aria-checked="false" tabindex="-1">App-based / Push Notifications</div>
                <div class="option" data-score="4" role="radio" aria-checked="false" tabindex="-1">Phish-resistant (FIDO2 / Yubikey)</div>
            </div>
        </div>

        <div class="question-card" data-pillar="Network">
            <h3 id="question-network">Network: How is access managed?</h3>
            <div class="options" role="radiogroup" aria-labelledby="question-network">
                <div class="option" data-score="1" role="radio" aria-checked="false" tabindex="0">Flat network / Perimeter-based</div>
                <div class="option" data-score="2" role="radio" aria-checked="false" tabindex="-1">Macro-segmentation (VLANs)</div>
                <div class="option" data-score="3" role="radio" aria-checked="false" tabindex="-1">Micro-segmentation / VPN-based</div>
                <div class="option" data-score="4" role="radio" aria-checked="false" tabindex="-1">Software Defined Perimeter (ZTNA)</div>
            </div>
        </div>

        <div class="question-card" data-pillar="Device">
            <h3 id="question-device">Device: How do you verify device health?</h3>
            <div class="options" role="radiogroup" aria-labelledby="question-device">
                <div class="option" data-score="1" role="radio" aria-checked="false" tabindex="0">Not verified / Bring Your Own Device</div>
                <div class="option" data-score="2" role="radio" aria-checked="false" tabindex="-1">Asset Inventory only</div>
                <div class="option" data-score="3" role="radio" aria-checked="false" tabindex="-1">Compliance check at login</div>
                <div class="option" data-score="4" role="radio" aria-checked="false" tabindex="-1">Continuous health monitoring (EDR)</div>
            </div>
        </div>

        <button id="calculate-btn" class="button" style="width: 100%;">Calculate Maturity Level</button>
    </div>

    <div id="result-container">
        <h2>Your Maturity Level:</h2>
        <div id="maturity-badge" class="maturity-badge"></div>
        <p id="maturity-desc" style="margin-top: 2rem;"></p>
        <div class="button-container">
            <a href="processes.html" class="button button-secondary">View Implementation Roadmap</a>
        </div>
    </div>
  </main>

  <script src="js/search-data.js"></script>
  <script src="js/search.js"></script>
  <script>
      const options = document.querySelectorAll('.option');

      function selectOption(optionEl) {
          const parent = optionEl.parentElement;
          // Deselect others in the same card
          parent.querySelectorAll('.option').forEach(o => {
              o.classList.remove('selected');
              o.setAttribute('aria-checked', 'false');
              o.setAttribute('tabindex', '-1');
          });
          // Select this one
          optionEl.classList.add('selected');
          optionEl.setAttribute('aria-checked', 'true');
          optionEl.setAttribute('tabindex', '0');
      }

      options.forEach(option => {
          option.addEventListener('click', function() {
              selectOption(this);
          });

          option.addEventListener('keydown', function(e) {
              if (e.key === ' ' || e.key === 'Enter') {
                  e.preventDefault();
                  selectOption(this);
              }

              // Arrow key navigation within the radiogroup
              const parent = this.parentElement;
              const siblings = Array.from(parent.querySelectorAll('.option'));
              const currentIndex = siblings.indexOf(this);

              let nextIndex = null;
              if (e.key === 'ArrowDown' || e.key === 'ArrowRight') {
                  nextIndex = (currentIndex + 1) % siblings.length;
              } else if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {
                  nextIndex = (currentIndex - 1 + siblings.length) % siblings.length;
              }

              if (nextIndex !== null) {
                  e.preventDefault();
                  const nextOption = siblings[nextIndex];
                  selectOption(nextOption);
                  nextOption.focus();
              }
          });
      });

      document.getElementById('calculate-btn').addEventListener('click', () => {
          const selected = document.querySelectorAll('.option.selected');
          if (selected.length < 3) {
              alert('Please answer all questions.');
              return;
          }

          let totalScore = 0;
          selected.forEach(s => totalScore += parseInt(s.dataset.score));
          const average = totalScore / 3;

          document.getElementById('quiz').style.display = 'none';
          document.getElementById('result-container').style.display = 'block';

          const badge = document.getElementById('maturity-badge');
          const desc = document.getElementById('maturity-desc');

          if (average <= 1.5) {
              badge.textContent = 'Traditional';
              badge.className = 'maturity-badge badge-hard';
              desc.textContent = 'You are relying on perimeter defenses. You are highly vulnerable to lateral movement.';
          } else if (average <= 2.5) {
              badge.textContent = 'Initial';
              badge.className = 'maturity-badge badge-medium';
              desc.textContent = 'You have started the journey. Basic MFA and segmentation are in place, but lack automation.';
          } else if (average <= 3.5) {
              badge.textContent = 'Advanced';
              badge.className = 'maturity-badge badge-easy';
              desc.textContent = 'Strong Zero Trust foundations. Most access is context-based and logged.';
          } else {
              badge.textContent = 'Optimal';
              badge.style.backgroundColor = 'var(--success-color)';
              badge.style.color = 'white';
              desc.textContent = 'You have achieved a fully dynamic, identity-centric environment with continuous validation.';
          }
      });
  </script>

  <footer>
    <p>&copy; Zero Trust. | <a href="privacy.html">Privacy Policy</a></p>
  </footer>
  <script src="js/ui.js"></script>
</body>
</html>
